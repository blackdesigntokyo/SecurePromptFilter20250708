# SecurePromptFilter20250708

プロンプト内の機密情報を、自動的に匿名化するPythonツールです。

ローカルで起動し、企業名、メールアドレス、電話番号、個人名、住所などの機密情報をダミーデータに置き換えます。

匿名化されたプロンプトを、ChatGPTなどのクラウドLLMに入力することを想定しています。

## 機能

- **固定置換**: 自社や関係企業など、よく使用する企業を、特定情報に置き換え（事前登録が必要）
- **正規表現パターンマッチング**: 以下の情報を自動検出・匿名化
  - 企業名（株式会社形式）
  - メールアドレス
  - 電話番号
  - 個人名
  - 郵便番号
  - 住所

## インストール

### 必要な依存関係

```bash
pip install regex pytest
```

### ファイル構成

```
SecurePromptFilter20250708/
├── anonymizer.py              # メインプログラム
├── anonymization_config.json  # 匿名化設定ファイル
└── README.md                  # このファイル
```

## 使用方法

### 基本的な使用方法

```bash
python anonymizer.py
```

プログラムを実行すると、対話的にプロンプトを入力できます：

```
--- プロンプト匿名化ツール ---
プロンプトを入力してください。終了するには 'exit' または '終了' と入力してください。

あなたのプロンプト: 株式会社Aの田中太郎さん（tanaka@example.com）に連絡してください。電話番号は03-1234-5678です。

--- 匿名化されたプロンプト ---
ダミー企業Xの[氏名]さん（dummy@example.com）に連絡してください。電話番号は000-0000-0000です。
----------------------------
```

### プログラム内での使用

```python
from anonymizer import anonymize_prompt, load_anonymization_config

# 設定ファイルを読み込み
config = load_anonymization_config("anonymization_config.json")

# プロンプトを匿名化
original_text = "株式会社Bの山田花子さんに連絡してください。"
anonymized_text = anonymize_prompt(original_text, config)
print(anonymized_text)
```

## 設定ファイル

`anonymization_config.json` で匿名化のルールを定義します：

### 固定置換

自社や関係企業など、よく使用する企業を、特定情報に置き換え。
AI生成の精度を上げるために、［精密部品製造の社員300人の上場企業］など業種や規模などを明記することが効果的です。
（事前登録が必要）

```json
    "fixed_replacements": {
        "株式会社まるまる商事": "［精密部品製造の社員300人の上場企業］",
        "株式会社ビック工業": "［ITサービスを提供する中小企業］",
        "クリエイティブコモンズ社": "［地域密着型スーパー］"
    }
```

### 正規表現パターン

複数のパターンで機密情報を検出・置換します：

```json
{
    "patterns": [
        {
            "regex": "株式会社(.+?)(?:$|\\s|、|。)",
            "type": "company_jp_suffix",
            "replacements": [
                "精密部品製造の社員300人の上場企業",
                "ITサービスを提供する中小企業",
                "地域密着型スーパー"
            ]
        }
    ]
}
```

## 設定のカスタマイズ

### 新しい置換パターンの追加

1. `anonymization_config.json` を開く
2. `fixed_replacements` または `patterns` セクションに新しいルールを追加
3. 正規表現パターンの場合は、`regex`、`type`、`replacements` を定義

### パターンの種類

- `company_jp_suffix`: 株式会社〇〇形式の企業名
- `company_jp_prefix`: 〇〇株式会社形式の企業名
- `email`: メールアドレス
- `phone`: 電話番号
- `person_name`: 個人名
- `zip_code`: 郵便番号
- `address`: 住所


## セキュリティ上の注意

- このツールは機密情報の検出・置換を行いますが、100%の精度を保証するものではありません（速度優先で正規表現だけで処理しているので、不完全な出力になることもあります）
- 重要な機密情報を含むプロンプトは、手動で最終確認を行ってください
- 設定ファイルには機密情報を含めないでください


## 貢献

バグ報告や機能改善の提案は、GitHubのIssuesページでお願いします。

## 更新履歴

- 2025-01-08: 初回リリース
  - 基本的な匿名化機能の実装
  - 設定ファイルによるカスタマイズ機能
  - 対話的なプロンプト入力機能
